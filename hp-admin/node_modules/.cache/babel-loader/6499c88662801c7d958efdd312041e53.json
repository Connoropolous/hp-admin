{"ast":null,"code":"import _defineProperty from \"/home/lisa/Documents/gitrepos/holochain/holo/happyTeam/hp-admin/hp-admin/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport HyloDnaInterface from 'data-interfaces/HyloDnaInterface';\nimport HappStoreDnaInterface, { getHappDetails } from 'data-interfaces/HappStoreDnaInterface';\nimport HhaDnaInterface from 'data-interfaces/HhaDnaInterface';\nimport EnvoyInterface from 'data-interfaces/EnvoyInterface';\nimport HoloFuelDnaInterface from 'data-interfaces/HoloFuelDnaInterface';\nimport { promiseMap } from 'utils';\nimport { dataMappedCall, toUiData } from \"./dataMapping\"; // TODO: dataMapping should probably be happening in the data-interfaces\n\nexport const resolvers = {\n  Query: {\n    me: async () => toUiData('person', (await HyloDnaInterface.currentUser.get())),\n    happStoreUser: () => HappStoreDnaInterface.currentUser.get(),\n    hostingUser: () => HhaDnaInterface.currentUser.get(),\n    happs: () => promiseMap(HhaDnaInterface.happs.all(), getHappDetails),\n    hostPricing: () => HhaDnaInterface.hostPricing.get(),\n    holofuelUser: (_, {\n      agentId\n    }) => HoloFuelDnaInterface.user.get({\n      agentId\n    }),\n    holofuelWaitingTransactions: () => HoloFuelDnaInterface.transactions.allWaiting(),\n    holofuelActionableTransactions: () => HoloFuelDnaInterface.transactions.allActionable(),\n    holofuelCompletedTransactions: () => HoloFuelDnaInterface.transactions.allCompleted(),\n    holofuelLedger: () => HoloFuelDnaInterface.ledger.get(),\n    happ: (_, {\n      id\n    }) => {\n      const happ = HhaDnaInterface.happs.get(id);\n      const happmapped = happ.then(getHappDetails);\n      return happmapped;\n    }\n  },\n  Mutation: {\n    registerUser: (_, userData) => dataMappedCall('person', userData, HyloDnaInterface.currentUser.create),\n    registerHostingUser: () => HhaDnaInterface.currentUser.create(),\n    enableHapp: async (_, {\n      appId\n    }) => {\n      const success = await EnvoyInterface.happs.install(appId);\n      if (!success) throw new Error('Failed to install app in Envoy');\n      await HhaDnaInterface.happs.enable(appId);\n\n      const happ = _objectSpread({}, (await HhaDnaInterface.happs.get(appId)), {\n        isEnabled: true\n      });\n\n      return getHappDetails(happ);\n    },\n    disableHapp: async (_, data) => {\n      const appId = data.appId;\n      await HhaDnaInterface.happs.disable(appId);\n\n      const happ = _objectSpread({}, (await HhaDnaInterface.happs.get(appId)), {\n        isEnabled: false\n      });\n\n      return getHappDetails(happ);\n    },\n    updateHostPricing: (_, {\n      units,\n      pricePerUnit\n    }) => HhaDnaInterface.hostPricing.update(units, pricePerUnit),\n    holofuelRequest: async (_, {\n      counterparty,\n      amount\n    }) => HoloFuelDnaInterface.requests.create(counterparty, amount),\n    holofuelOffer: async (_, {\n      counterparty,\n      amount,\n      requestId\n    }) => HoloFuelDnaInterface.offers.create(counterparty, amount, requestId),\n    holofuelAcceptOffer: (_, {\n      transactionId\n    }) => HoloFuelDnaInterface.offers.accept(transactionId),\n    holofuelDecline: (_, {\n      transactionId\n    }) => HoloFuelDnaInterface.transactions.decline(transactionId),\n    holofuelCancel: (_, {\n      transactionId\n    }) => HoloFuelDnaInterface.transactions.cancel(transactionId)\n  }\n};\nexport default resolvers;","map":{"version":3,"sources":["/home/lisa/Documents/gitrepos/holochain/holo/happyTeam/hp-admin/hp-admin/src/graphql-server/resolvers.js"],"names":["HyloDnaInterface","HappStoreDnaInterface","getHappDetails","HhaDnaInterface","EnvoyInterface","HoloFuelDnaInterface","promiseMap","dataMappedCall","toUiData","resolvers","Query","me","currentUser","get","happStoreUser","hostingUser","happs","all","hostPricing","holofuelUser","_","agentId","user","holofuelWaitingTransactions","transactions","allWaiting","holofuelActionableTransactions","allActionable","holofuelCompletedTransactions","allCompleted","holofuelLedger","ledger","happ","id","happmapped","then","Mutation","registerUser","userData","create","registerHostingUser","enableHapp","appId","success","install","Error","enable","isEnabled","disableHapp","data","disable","updateHostPricing","units","pricePerUnit","update","holofuelRequest","counterparty","amount","requests","holofuelOffer","requestId","offers","holofuelAcceptOffer","transactionId","accept","holofuelDecline","decline","holofuelCancel","cancel"],"mappings":"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","sourcesContent":["import HyloDnaInterface from 'data-interfaces/HyloDnaInterface'\nimport HappStoreDnaInterface, { getHappDetails } from 'data-interfaces/HappStoreDnaInterface'\nimport HhaDnaInterface from 'data-interfaces/HhaDnaInterface'\nimport EnvoyInterface from 'data-interfaces/EnvoyInterface'\nimport HoloFuelDnaInterface from 'data-interfaces/HoloFuelDnaInterface'\nimport { promiseMap } from 'utils'\nimport {\n  dataMappedCall,\n  toUiData\n} from './dataMapping'\n// TODO: dataMapping should probably be happening in the data-interfaces\n\nexport const resolvers = {\n  Query: {\n    me: async () => toUiData('person', await HyloDnaInterface.currentUser.get()),\n\n    happStoreUser: () => HappStoreDnaInterface.currentUser.get(),\n\n    hostingUser: () => HhaDnaInterface.currentUser.get(),\n\n    happs: () => promiseMap(HhaDnaInterface.happs.all(), getHappDetails),\n\n    hostPricing: () => HhaDnaInterface.hostPricing.get(),\n\n    holofuelUser: (_, { agentId }) => HoloFuelDnaInterface.user.get({ agentId }),\n\n    holofuelWaitingTransactions: () => HoloFuelDnaInterface.transactions.allWaiting(),\n\n    holofuelActionableTransactions: () => HoloFuelDnaInterface.transactions.allActionable(),\n\n    holofuelCompletedTransactions: () => HoloFuelDnaInterface.transactions.allCompleted(),\n\n    holofuelLedger: () => HoloFuelDnaInterface.ledger.get(),\n\n    happ: (_, { id }) => {\n      const happ = HhaDnaInterface.happs.get(id)\n      const happmapped = happ.then(getHappDetails)\n      return happmapped\n    }\n  },\n\n  Mutation: {\n    registerUser: (_, userData) => dataMappedCall('person', userData, HyloDnaInterface.currentUser.create),\n\n    registerHostingUser: () => HhaDnaInterface.currentUser.create(),\n\n    enableHapp: async (_, { appId }) => {\n      const success = await EnvoyInterface.happs.install(appId)\n      if (!success) throw new Error('Failed to install app in Envoy')\n      await HhaDnaInterface.happs.enable(appId)\n      const happ = {\n        ...await HhaDnaInterface.happs.get(appId),\n        isEnabled: true\n      }\n      return getHappDetails(happ)\n    },\n\n    disableHapp: async (_, data) => {\n      const { appId } = data\n      await HhaDnaInterface.happs.disable(appId)\n      const happ = {\n        ...await HhaDnaInterface.happs.get(appId),\n        isEnabled: false\n      }\n      return getHappDetails(happ)\n    },\n\n    updateHostPricing: (_, { units, pricePerUnit }) => HhaDnaInterface.hostPricing.update(units, pricePerUnit),\n\n    holofuelRequest: async (_, { counterparty, amount }) => HoloFuelDnaInterface.requests.create(counterparty, amount),\n\n    holofuelOffer: async (_, { counterparty, amount, requestId }) => HoloFuelDnaInterface.offers.create(counterparty, amount, requestId),\n\n    holofuelAcceptOffer: (_, { transactionId }) => HoloFuelDnaInterface.offers.accept(transactionId),\n\n    holofuelDecline: (_, { transactionId }) => HoloFuelDnaInterface.transactions.decline(transactionId),\n\n    holofuelCancel: (_, { transactionId }) => HoloFuelDnaInterface.transactions.cancel(transactionId)\n  }\n}\n\nexport default resolvers\n"]},"metadata":{},"sourceType":"module"}